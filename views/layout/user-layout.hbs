<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>

   

    <!-- SEO Meta Tags -->
    <meta name="description" content="Find the perfect flat property for you. Browse our extensive listings and discover your dream home today.">
    <meta name="keywords" content="
flats for sale, apartments for rent, luxury apartments, housing projects, commercial properties, 
residential properties, villas and bungalows, flats in New York, properties near me, real estate in New York, 
buy a house, sell property online, real estate investment, affordable housing, property prices in New York, 
apartments for lease, short-term rentals, houses for rent, gated community apartments, pet-friendly apartments, 
smart homes, sustainable homes, real estate agents, property management services, home loan assistance, 
real estate consultancy, top real estate companies, property market trends, upcoming properties, real estate listings">
    <meta name="author" content="Your Company Name">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://assetshunter.in/images/househunter.jpg">
    <meta property="og:title" content="Find Flat Properties | Property Finder">
    <meta property="og:description" content="Find the perfect flat property for you. Browse our extensive listings and discover your dream home today.">
    <meta property="og:image" content="http://assetshunter.in/images/househunter.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="http://assetshunter.in/images/househunter.jpg">
    <meta property="twitter:title" content="Find Flat Properties | Property Finder">
    <meta property="twitter:description" content="Find the perfect flat property for you. Browse our extensive listings and discover your dream home today.">
    <meta property="twitter:image" content="http://assetshunter.in/images/househunter.jpg">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">
    <!-- Favicon -->
    <link rel="shortcut icon" href="/images/favicon.jpg" type="image/x-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Plugin CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" rel="stylesheet">
    <link href="https://unpkg.com/swiper@8/swiper-bundle.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/stylesheets/style.css">

    <!-- Additional page-specific styles -->
    {{{_sections.styles}}}
</head>
<body>
    <!-- Loader -->
    <div id="preloader">
        <div class="loader">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>

    <!-- Conditional Header Rendering -->
    {{#if user}}
        {{> user-header}}
    {{else}}
        {{> admin-header}}
    {{/if}}

    <!-- Main Content -->
    {{{body}}}

    <!-- Footer -->
    {{> footer}}

    <!-- Back to Top Button -->
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center">
        <i class="fas fa-arrow-up"></i>
    </a>

 <!-- Add this at the end of your body tag, just before closing </body> -->
<div id="contactModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Get in Touch</h2>
        <form id="contactForm">
            <div class="form-group">
                <input type="text" id="name" name="name" placeholder="Your Name" required>
            </div>
                <!-- Existing fields -->
    <input type="hidden" name="pageUrl" value="">
    <input type="hidden" name="timestamp" value="">
            <div class="form-group">
                <input type="email" id="email" name="email" placeholder="Email Address" required>
            </div>
            <div class="form-group">
                <input type="tel" id="mobile" name="mobile" placeholder="Mobile Number" required>
            </div>
            <div class="form-group">
                <textarea id="message" name="message" placeholder="Your Message" required></textarea>
            </div>
            <div class="form-group">
                <input type="text" id="captcha" name="captcha" placeholder="Enter the 6-digit code" required>
                <div id="captcha-display" class="captcha-display"></div>
                <button type="button" class="refresh-captcha">Refresh</button>
            </div>
            <div class="center-container">
    <button type="submit" class="minimal-button">Submit</button>
</div>

           
        </form>
    </div>
</div>


    <!-- Core JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Plugin JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sticky-js@1.3.0/dist/sticky.min.js"></script>
    
    <!-- Custom Scripts -->
    <script src="/javascripts/statesandcities.js"></script>
<script>// Modal and Form Handler Script
document.addEventListener('DOMContentLoaded', function() {
    // Get modal elements
    const modal = document.getElementById('contactModal');
    const closeButton = document.querySelector('.close-button');
    const form = document.getElementById('contactForm');

    // Get UTM parameters
    const urlParams = new URLSearchParams(window.location.search);
    const utmParams = {
        source: urlParams.get('utm_source') || 'direct',
        medium: urlParams.get('utm_medium') || 'none',
        campaign: urlParams.get('utm_campaign') || 'none',
        term: urlParams.get('utm_term') || 'none',
        content: urlParams.get('utm_content') || 'none'
    };

    // Show modal after 5 seconds
    setTimeout(() => {
        modal.style.display = 'block';
    }, 5000);

    // Close modal when clicking close button
    closeButton.onclick = function() {
        modal.style.display = 'none';
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    }

    // Generate CAPTCHA code
    function generateCaptcha() {
        const captchaDisplay = document.getElementById('captcha-display');
        const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        let captcha = '';
        for (let i = 0; i < 6; i++) {
            captcha += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        captchaDisplay.textContent = captcha;
        return captcha;
    }

    // Initial CAPTCHA generation
    let currentCaptcha = generateCaptcha();

    // Refresh CAPTCHA
    document.querySelector('.refresh-captcha').onclick = function() {
        currentCaptcha = generateCaptcha();
    }

    // Form validation
    function validateForm(formData) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const phoneRegex = /^[0-9]{10}$/;

        if (!emailRegex.test(formData.get('email'))) {
            alert('Please enter a valid email address');
            return false;
        }

        if (!phoneRegex.test(formData.get('mobile'))) {
            alert('Please enter a valid 10-digit mobile number');
            return false;
        }

        return true;
    }

    // Handle form submission
    form.addEventListener('submit', async function(e) {
        e.preventDefault();

        // Validate CAPTCHA
        const userCaptcha = document.getElementById('captcha').value.toUpperCase();
        if (userCaptcha !== currentCaptcha) {
            alert('Invalid CAPTCHA code!');
            currentCaptcha = generateCaptcha();
            document.getElementById('captcha').value = '';
            return;
        }

        // Get form data
        const formData = new FormData(form);

        // Validate form
        if (!validateForm(formData)) {
            return;
        }

        // Add UTM parameters and additional data
        const submitData = {
            name: formData.get('name'),
            email: formData.get('email'),
            mobile: formData.get('mobile'),
            message: formData.get('message'),
            utmSource: utmParams.source,
            utmMedium: utmParams.medium,
            utmCampaign: utmParams.campaign,
            utmTerm: utmParams.term,
            utmContent: utmParams.content,
            pageUrl: window.location.href,
            timestamp: new Date().toISOString()
        };

        // Show loading state
        const submitButton = form.querySelector('button[type="submit"]');
        submitButton.disabled = true;
        submitButton.innerHTML = 'Submitting...';

        try {
            const response = await fetch('/submit-form', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: JSON.stringify(submitData)
            });

            const result = await response.json();

            if (result.success) {
                alert('Form submitted successfully!');
                form.reset();
                modal.style.display = 'none';
                
                // Track successful submission
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'form_submission', {
                        'event_category': 'Engagement',
                        'event_label': 'Popup Form',
                        'value': 1
                    });
                }
            } else {
                alert(result.message || 'Failed to submit form. Please try again.');
            }
        } catch (error) {
            console.error('Error submitting form:', error);
            alert('An error occurred. Please try again later.');
        } finally {
            // Reset button state
            submitButton.disabled = false;
            submitButton.innerHTML = 'Submit';
            // Generate new CAPTCHA
            currentCaptcha = generateCaptcha();
        }
    });
});</script>

    <!-- Initialize Global Scripts -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize AOS
            AOS.init({
                duration: 800,
                easing: 'ease-in-out',
                once: true,
                mirror: false
            });

            // Initialize Select2
            if ($.fn.select2) {
                $('.select2').select2({
                    width: '100%',
                    minimumResultsForSearch: 10
                });
            }

            // Initialize GLightbox
            if (typeof GLightbox !== 'undefined') {
                const lightbox = GLightbox({
                    touchNavigation: true,
                    loop: true,
                    autoplayVideos: true
                });
            }

            // Handle flash messages
            {{#if success}}
                alertify.success('{{success}}');
            {{/if}}

            {{#if error}}
                alertify.error('{{error}}');
            {{/if}}

            // Back to top button
            const backToTop = document.querySelector('.back-to-top');
            if (backToTop) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 100) {
                        backToTop.classList.add('active');
                    } else {
                        backToTop.classList.remove('active');
                    }
                });

                backToTop.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }

            // Remove preloader
            const preloader = document.querySelector('#preloader');
            if (preloader) {
                window.addEventListener('load', () => {
                    preloader.remove();
                });
            }
        });
    </script>

    <!-- Additional page-specific scripts -->
    {{{_sections.scripts}}}
</body>
</html>